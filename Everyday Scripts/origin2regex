#!/bin/bash

# Dig all IP adresses by origin of given IP and them turned into regular expressions

DIG_IP="$(dig $1 +short | head -1)"
ORIGIN="$(whois -h whois.radb.net ${DIG_IP} | grep origin: |awk '$0=$2')"

for IP in $(whois -h whois.radb.net -i origin -T route ${ORIGIN} | grep -w "route:" | awk '{print $NF}' | sort -n); do
    rgxg cidr $IP;
done
